
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="7tTF0t5uCMnyE6X31OIOQpcOf4QxWuODtyZLoVsKCEc"/>
    <meta name="msvalidate.01" content="7FC9C7BCD4002EBD89AAC2EF63D7B353"/>
    <link rel="icon" type="image/png" href="favicon48.png" sizes="48x48">
    <title>Using the I2C bus</title>
    <meta name='description' content='Examples and documentation for the HomeDing IoT Library'>
    <link content-type="text/css" href="/docstyle.css" rel="stylesheet"/>
    <script src="/pages.js"></script>
    <script src="/story.js" type="module"></script>
  </head>
  <body scroll="0" style="padding:0;">
    <div class="u-navbar" style="margin-bottom: 0;">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48" id="menuButton" class="button" style="height:1.4rem">
        <path fill="white" d="M0 8h48v6H0zm0 13h48v6H0zm0 13h48v6H0z"/>
      </svg>
      <a href="/index.htm" class="button">Home</a>
      <a href="/elements/index.htm" class="button">Elements</a>
      <a href="/boards/index.htm" class="button">Boards</a>
      <a href="/recipes/index.htm" class="button">Recipes</a>
    </div>
    <nav></nav>
    <main style="padding:1rem;max-width: 800px;">
      <h1>Using the I2C bus</h1>
      
        
            <div class="plaincard">
            
            The I2C bus is used by many components, sensors, displays and other chips to communicate commands and data. A central configuration is supported on the device level.

          </div>
        
        <p>The data transfer is not as fast as the SPI bus but it is easy to implement
because only 2 IO lines are required and there are no chip specific signals
required as every participant has a dedicated I2C address.</p>
<p>The ESP8266 and ESP32 SoC doesnâ€™t have many GPIO lines so using a bus enables more components in the same device.</p>
<h2>Wiring</h2>
<p>I2C requires 4 wires for power and data communication.</p>
<p>Using the default I2C bus pins:</p>
<table>
<thead>
<tr>
<th>Signal</th>
<th>ESP8266</th>
<th>ESP32</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="gpio black">GND</span></td>
<td>GND</td>
<td>GND</td>
<td>Ground for I2C and Power Supply</td>
</tr>
<tr>
<td><span class="gpio red">VCC</span></td>
<td>3.3v</td>
<td>3.3v</td>
<td>Power Supply</td>
</tr>
<tr>
<td><span class="gpio blue">SDA</span></td>
<td>GPIO4(D2)</td>
<td>IO21</td>
<td>I2C Data Signal</td>
</tr>
<tr>
<td><span class="gpio yellow">SCL</span></td>
<td>GPIO5(D1)</td>
<td>IO22</td>
<td>I2C Clock Signal</td>
</tr>
</tbody>
</table>
<p>The I2C bus can be used with 3.3V and 5V master and slave devices. Please check specific datasheets.</p>
<h3>Wiring of I2C Connectors by Adafruit</h3>
<p>Adafruit uses JST PH 4-Pin (2mm) connectors on some boards
The wires offered are color-coded:</p>
<ul>
<li>Black for GND</li>
<li>Red for V+</li>
<li>White for SDA</li>
<li>Green for SCL</li>
</ul>
<h3>Wiring of I2C Qwiic Connectors by Sparkfun</h3>
<p>Sparkfun uses a JST SH 4-pin (1mm) connector on many boards.</p>
<p>They use a different connector and color scheme but the same order of signals.</p>
<ul>
<li>Black = GND</li>
<li>Red = 3.3V</li>
<li>Blue = SDA</li>
<li>Yellow = SCL</li>
</ul>
<h3>Additional signals</h3>
<p>Some chips and boards that use the I2C bus for communication also have some more signals to be controlled
like signals to reset the chips or power on/off.</p>
<p>These are not connected using the 4 core signals and need to be connected by additional wiring.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>The <a href="/elements/display/sh1106.htm">OLED Display SH1106</a> is an example that offers a reset pin
to also enable/disable the display and controlling power consumption before using the I2C bus.</li>
<li>The CCS811 sensor offers a signal (INT) that can be used to trigger a software interrupt
when data is ready instead of polling for state.</li>
</ul>
<h2>Wire Library and supporting utilities</h2>
<p>The WireUtil Class in the HomeDing library helps implementing I2C bus data transfers using a data buffer. This class implements some of the common procedures that help implementing I2C based communication to sensors and other chips
by using local byte buffers for sending and receiving data.</p>
<p>It also offers a possibility of dumping the data into the Serial Debug Output for analysis.</p>
<p>Often I2C adaptions are using a (logical) register based access pattern.
Here a data centric access is implemented that separates reading / writing data to a buffer from interpretation of the data in the buffer.
That fits well to those processor implementations that support I2C data exchange through dma implementations.</p>
<h2>I2C addresses and chips using them</h2>
<p>Some addresses used by the chips of HomeDing Elements:</p>
<table>
<thead>
<tr>
<th>address</th>
<th>used by chips</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x11</td>
<td>SI4721</td>
</tr>
<tr>
<td>0x27</td>
<td>LCD,PCF8574</td>
</tr>
<tr>
<td>0x38</td>
<td>AHT20</td>
</tr>
<tr>
<td>0x3C</td>
<td>SH1106,SSD1306,SSD1309</td>
</tr>
<tr>
<td>0x40</td>
<td>INA219,INA226</td>
</tr>
<tr>
<td>0x51</td>
<td>RTC,PCF8563</td>
</tr>
<tr>
<td>0x5c</td>
<td>AM2320</td>
</tr>
<tr>
<td>0x62</td>
<td>SCD-4x</td>
</tr>
<tr>
<td>0x63</td>
<td>Radio,SI4730</td>
</tr>
<tr>
<td>0x68</td>
<td>RTC,DS1307,MPU9250</td>
</tr>
<tr>
<td>0x69</td>
<td>MPU9250</td>
</tr>
<tr>
<td>0x76</td>
<td>BMP280</td>
</tr>
<tr>
<td>0x77</td>
<td>BMP280, BME680</td>
</tr>
</tbody>
</table>
<p>A more complete list can be found at <a href="https://i2cdevices.org/addresses">https://i2cdevices.org/addresses</a></p>
<h2>See also</h2>
<ul>
<li><a href="https://www.adafruit.com/product/3950">https://www.adafruit.com/product/3950</a></li>
<li><a href="https://www.sparkfun.com/qwiic#faqs">https://www.sparkfun.com/qwiic#faqs</a></li>
<li><a href="https://www.smart-prototyping.com/Qwiic.html">https://www.smart-prototyping.com/Qwiic.html</a></li>
<li><a href="https://diyi0t.com/i2c-tutorial-for-arduino-and-esp8266/">https://diyi0t.com/i2c-tutorial-for-arduino-and-esp8266/</a></li>
<li><a href="https://github.com/technoblogy/i2c-detective">https://github.com/technoblogy/i2c-detective</a></li>
<li><a href="/dev/spi.htm">Using the SPI bus</a></li>
</ul>

        
          <h2>Tags</h2>
          <div class="taglist">
            
              <a href="/tag/implementation.htm">Implementation</a>
            
          </div>
        
      </main>
      <script>
        const param = {
          MENU_MIN_WIDTH: 1030
        };
        var mbObj = document.querySelector('#menuButton');
        var navObj = document.querySelector('nav');
        if (window.innerWidth > param.MENU_MIN_WIDTH) { // menu is inside the page
          navObj.classList.add('open');
          navObj.classList.add('inpage');
        }
        mbObj.addEventListener('click', function (e) {
          navObj.classList.toggle('open');
        });
        lazyLoadHTM('nav', '/toc.htm');
      </script>
    </body>
  </body>
</html>