
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NTPTime Element</title>
  <script src="/pages.js"></script>
  <link content-type="text/css" href="/docstyle.css" rel="stylesheet"/>
  <script src="/story.js" type="module"></script>
  <link rel="icon" type="image/png" href="/favicon48.png" sizes="48x48">
  <meta name='description' content='Support getting local time from the internet using NTP protocol.'>
  <meta name="google-site-verification" content="7tTF0t5uCMnyE6X31OIOQpcOf4QxWuODtyZLoVsKCEc"/>
  <meta name="msvalidate.01" content="7FC9C7BCD4002EBD89AAC2EF63D7B353"/>
</head>

<body class="sitelayout" style="--content-width:800px">
  <div class="navbar">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48" id="menuButton" class="button" style="height:1.4rem">
      <path fill="white" d="M0 8h48v6H0zm0 13h48v6H0zm0 13h48v6H0z"/>
    </svg>
    <a href="/index.htm" class="button">Home</a>
    <a href="/elements/index.htm" class="button">Elements</a>
    <a href="/boards/index.htm" class="button">Boards</a>
    <a href="/recipes/index.htm" class="button">Recipes</a>
  </div>
  
  <nav style="background-color:white"></nav>

  <main>
    <h1>NTPTime Element</h1>

    
      <div class="card-container horizontal text" style="--card-height:5rem;--card-image-size:5rem;">
        <div class="card">
          
            <svg>
              <use href="/icons.svg#ntptime"></use>
            </svg>
          
          <div class="body">
            <p>The NTPTimeElement can retrieve the local time from an external NTP server using the ntp protocol on the internet.</p>

          </div>
        </div>
      </div>
    

    <p>The NTPTimeElement is one of the time elements that are used to get a local time from a external source
and to adjust the <code>real local time</code>w on the board.</p>
<p>This element gets the local time from an external server using the Network Time Protocol (NTP).</p>
<p>In the SDK of some platforms like the ESP8266 the functionality to get a NTP based time sync is already available but it must be configured and activated.
This is what the NTPTimeElement does for the ESP8266 (and ESP32 later).</p>
<p>Because retrieving the right local time can be done using different methods the NTPTime Element is an extension to the building clock functionality of the board that keeps the current time available as accurate as the internal quartz oscillator can do.</p>
<h2>Network Time Protocol (NTP)</h2>
<p>The NTP protocol is supported by many operating systems and is the common protocol to sync the board clocks of computers and server.</p>
<p>You can find many NTP servers on the internet. The web site <a href="https://www.pool.ntp.org/en/">https://www.pool.ntp.org/en/</a> has a repository of available servers. Inside companies usually a local server is available.</p>
<p>Because it takes some time to get a package from the server and of course sometimes the server doesnâ€™t answer at all or network packages
are lost you cannot rely on getting a correct time immediately after starting the board or coming back from a <a href="/dev/deepsleep.htm">deep sleep mode</a>.
If you have a device with these requirements a chip based real-time like the  <a href="/elements/dstime.htm">DSTime Element</a> may be a better option.</p>
<h2>Element Configuration</h2>
<p>The following properties are available for configuration of the element.</p>
<p><object data="/element.svg?ntptime" type="image/svg+xml"></object></p>
<p><strong>ntpServer</strong> - The hostname of the ntp server to be used like <code>&quot;pool.ntp.org&quot;</code></p>
<p><strong>zone</strong> - Timezone of the device</p>
<p>The Timezone contains the name and offset and can include summer time adjustments. It is using the format used for the POSIX TZ environment variable.</p>
<p>See <a href="https://developer.ibm.com/technologies/systems/articles/au-aix-posix/">https://developer.ibm.com/technologies/systems/articles/au-aix-posix/</a> that explains the format for this configuration.</p>
<p>See <a href="https://raw.githubusercontent.com/nayarsystems/posix_tz_db/master/zones.csv">https://raw.githubusercontent.com/nayarsystems/posix_tz_db/master/zones.csv</a> or <strong>TZ.h</strong> for examples.</p>
<h3>Configuration Example</h3>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"ntptime"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"0"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"ntpserver"</span><span class="token operator">:</span> <span class="token string">"pool.ntp.org"</span><span class="token punctuation">,</span>
        <span class="token property">"zone"</span><span class="token operator">:</span> <span class="token string">"CET-1CEST,M3.5.0,M10.5.0/3"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2>Element State</h2>
<p>The following properties are available with the current values at runtime</p>
<p><strong>active</strong> - Is set to true when the element is active.</p>
<p><strong>now</strong>  the current time of the board.</p>
<h2>Element State Example</h2>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"ntptime/0"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"active"</span><span class="token operator">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>
    <span class="token property">"now"</span><span class="token operator">:</span> <span class="token string">"2018-11-22 20:43:08"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2>See also</h2>
<ul>
<li><a href="/elements/timeelements.htm">Time Elements</a></li>
</ul>


      
        <h2>Tags</h2>
        <div class="taglist"><a href="/tag/element.htm">Element</a><a href="/tag/time.htm">Time</a></div>
      
  </main>

  <script>
    var mbObj = document.querySelector('#menuButton');
    var navObj = document.querySelector('nav');
    mbObj.addEventListener('click', function (e) {
      navObj.classList.toggle('open');
    });
    lazyLoadHTM('nav', '/toc.htm');
  </script>

  <script type="module" async>
    import mermaid from "https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs";
    document.addEventListener('DOMContentLoaded', mermaid.initialize({startOnLoad: true}));
  </script>

</body>
</html>