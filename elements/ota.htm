<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="7tTF0t5uCMnyE6X31OIOQpcOf4QxWuODtyZLoVsKCEc" />
  <meta name="msvalidate.01" content="7FC9C7BCD4002EBD89AAC2EF63D7B353" />
  <link rel="icon" type="image/png" href="favicon48.png" sizes="48x48">
  <meta name='description' content=''>
  <title>OTA Element</title>
  <link Content-Type="text/css" href="/docstyle.css" rel="stylesheet" />
  <script src="/pages.js"></script>
  <style>
  .gpio { 
    display:inline-block;
    padding: 0 4px;
    border-radius: 4px;
    }
  .gpio.yellow {background-color: #FF0;}
  .gpio.red {background-color: #F22; color:white}
  .gpio.black {background-color: #111; color:white}
  .gpio.blue {background-color: #22F; color:white}
  </style>
</head>

<body scroll="0" style="padding:0;">
  <div class="u-navbar" style="margin-bottom: 0;">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="menuButton" class="button" style="height:1.4rem">
      <path fill="white" d="M0 8h48v6H0zm0 13h48v6H0zm0 13h48v6H0z" />
    </svg>

    <a href="/index.htm" class="button">Home</a>
    <a href="/concepts/index.htm" class="button">Concepts</a>
    <a href="/elements/index.htm" class="button">Elements</a>
    <a href="/boards/index.htm" class="button">Boards</a>
    <a href="/recipes/index.htm" class="button">Recipes</a>
  </div>

  <nav class="inpage open"></nav>

  <main style="padding:1rem">
    <h1>OTA Element</h1>
<div class="iconcard"><svg class="icon"><use href="/icons.svg#ota"></use></svg><p>The OTA Element allows to upload new firmware using the wireless network - Over The Air (OTA). <strong>The update doesn't work in safemode</strong> see <a href="/dev/safemode.htm">safemode</a>;</p>
</div>
<p>The OTAElement enables the upload of new sketch versions to the device over the network using the standard Arduino network based upload procedure. When this element is configured the device shows up in the list of ports in the Arduino programming environment.</p>
<p>The OTAElement is a system element to enable this functionality only. It cannot send or receive actions.</p>
<p>It uses the mDNS implementation to advertise the device for being reachable for updates.
Since the OTA Element initializes the mDNS protocol to register on the network no mDNS library needs to be used and initiated explicitly.</p>
<blockquote>
<hr>
<p>Over The Air (OTA) updates require that a sketch is already uploaded to the device that supports receiving updates.
Also the memory layout and especially the size of the SPIFFS space cannot be changed using this method.</p>
<p>The first upload must be done using the USB cable.</p>
<hr>
</blockquote>
<h2>Uploading tools</h2>
<p>If you use the Arduino IDE the device will show up in the list of ports.
The underlying thing is a python script that can be used directly as well.</p>
<h2>Upload batch</h2>
<p>There is a python 3 based tool available within the tools folder of the Arduino package for the ESP8266 board.
To use this tool you need to install Python 3 on your computer as well.</p>
<p>This script will push an OTA update to the ESP</p>
<pre><code>python.exe %LOCALAPPDATA%\Arduino15\packages\esp8266\hardware\esp8266\2.7.1\tools\espota.py -i %devicename% -p 8266 --auth=123 -f ..\temp\DevDing.ino.bin
</code></pre>
<p>(the version number and path to the ers8266 tools may vary)</p>
<p>use it like:</p>
<pre><code>python3 espota.py -i &lt;ESP_IP_address&gt; -I &lt;Host_IP_address&gt; -p &lt;ESP_port&gt; -P &lt;Host_port&gt; [-a password] -f &lt;sketch.bin&gt;
</code></pre>
<p>or to upload a SPIFFS image:</p>
<pre><code>python3 espota.py -i &lt;ESP_IP_address&gt; -I &lt;Host_IP_address&gt; -p &lt;ESP_port&gt; -P &lt;HOST_port&gt; [-a password] -s -f &lt;spiffs.bin&gt;
</code></pre>
<h2>Example Configuration</h2>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"ota"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"0"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">8266</span><span class="token punctuation">,</span><br>      <span class="token property">"passwd"</span><span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span><br>      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Listen for 'over the air' OTA Updates"</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h2>See also</h2>
<ul>
<li><a href="/dev/safemode.htm">safemode</a></li>
<li>Hardening the IoT device: <a href="https://arduino-esp8266.readthedocs.io/en/latest/ota_updates/readme.html">https://arduino-esp8266.readthedocs.io/en/latest/ota_updates/readme.html</a></li>
</ul>
<h2>Tags</h2>
<p>#element #system</p>
<!--

## TODO:signed firmware

- <https://www.mischianti.org/2021/10/02/esp8266-flash-compiled-and-signed-firmware-bin-1/>
- <https://www.mischianti.org/2022/01/09/esp8266-self-ota-update-in-https-ssl-tls-with-trusted-self-signed-certificate-3/>


-->

  </main>

  <script>
    var mbObj = document.querySelector('#menuButton');
    var navObj = document.querySelector('nav');

    navObj.classList.toggle('open', (window.innerWidth > 880));

    mbObj.addEventListener('click', function (e) {
      navObj.classList.toggle('open');
    });

    lazyLoadHTM('nav', '/toc.htm');
  </script>
  
  </body>

</html>