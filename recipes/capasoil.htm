<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="7tTF0t5uCMnyE6X31OIOQpcOf4QxWuODtyZLoVsKCEc" />
  <meta name="msvalidate.01" content="7FC9C7BCD4002EBD89AAC2EF63D7B353" />
  <link rel="icon" type="image/png" href="favicon48.png" sizes="48x48">
  <title>Capacitive Soil Moisture Sensor Recipe</title>
  <meta name='description' content='Examples and documentation for the HomeDing IoT Library'>
  <link Content-Type="text/css" href="/docstyle.css" rel="stylesheet" />
  <script src="/pages.js"></script>
  <script src="/story.js" type="module"></script>
  <style>
  .gpio { 
    display:inline-block;
    padding: 0 4px;
    border-radius: 4px;
    }
  .gpio.yellow {background-color: #FF0;}
  .gpio.red {background-color: #F22; color:white}
  .gpio.black {background-color: #111; color:white}
  .gpio.blue {background-color: #22F; color:white}
  main h2 {margin-top: 1rem !important;}
  </style>
</head>

<body scroll="0" style="padding:0;">
  <div class="u-navbar" style="margin-bottom: 0;">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="menuButton" class="button" style="height:1.4rem">
      <path fill="white" d="M0 8h48v6H0zm0 13h48v6H0zm0 13h48v6H0z" />
    </svg>

    <a href="/index.htm" class="button">Home</a>
    <a href="/elements/index.htm" class="button">Elements</a>
    <a href="/boards/index.htm" class="button">Boards</a>
    <a href="/recipes/index.htm" class="button">Recipes</a>
  </div>

  <nav></nav>

  <main style="padding:1rem;max-width: 800px;">
    <h1>Capacitive Soil Moisture Sensor Recipe</h1>

    
    
      <div class="plaincard">
    
    This recipe shows how to combine a Capacitive Soil Moisture Sensor with the Analog Input Element and a LED. 

    </div>
      
    <p>The Capacitive Soil Moisture Sensor is one of the sensors that creates a analog voltage level based on the surrounding moisture of the sensor.</p>
<p>To capture this value the analog output pin of the sensor just needs to be connected to the <strong>Vin</strong> or <strong>A0</strong>
that is giving the input for the <a href="/elements/analog.htm">Analog Input Element</a>.</p>
<p>You will find out that without any surrounding moisture the raw analog level is high in my case about the value of 700
and gets lower to about 300 when some moisture is around.</p>
<p>The mapping feature of the <a href="/elements/analog.htm">Analog Input Element</a> allows deriving a value between 0 and 100 from that range in the reverse direction
meaning percentage of existing water.</p>
<p>When the percentage drops below the given reference value in the configuration
an onReference action with a value of 0 is triggered that will switch the LED on GPIO D0.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"analog"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"0"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"reference"</span><span class="token operator">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>
      <span class="token property">"onvalue"</span><span class="token operator">:</span> <span class="token string">"device/0?log=value=$v"</span><span class="token punctuation">,</span>
      <span class="token property">"onlow"</span><span class="token operator">:</span> <span class="token string">"device/0?log=Need Water"</span><span class="token punctuation">,</span>
      <span class="token property">"readtimems"</span><span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
      <span class="token property">"mapInMin"</span><span class="token operator">:</span> <span class="token string">"750"</span><span class="token punctuation">,</span>
      <span class="token property">"mapInMax"</span><span class="token operator">:</span> <span class="token string">"200"</span><span class="token punctuation">,</span>
      <span class="token property">"mapOutMin"</span><span class="token operator">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>
      <span class="token property">"mapOutMax"</span><span class="token operator">:</span> <span class="token string">"100"</span><span class="token punctuation">,</span>
      <span class="token property">"onreference"</span><span class="token operator">:</span> <span class="token string">"digitalout/red?value=$v"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"digitalout"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"red"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Led showing low water situation."</span><span class="token punctuation">,</span>
      <span class="token property">"pin"</span><span class="token operator">:</span> <span class="token string">"D0"</span><span class="token punctuation">,</span>
      <span class="token property">"inverse"</span><span class="token operator">:</span> <span class="token string">"false"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2>See also</h2>
<ul>
<li><a href="https://diyi0t.com/soil-moisture-sensor-tutorial-for-arduino-and-esp8266/">https://diyi0t.com/soil-moisture-sensor-tutorial-for-arduino-and-esp8266/</a></li>
</ul>


    
    <h2>Tags</h2>
    <div class="taglist"><a href="/tag/recipe.htm">Recipe</a></div>
    
  </main>

  <script>
    const param = {
      MENU_MIN_WIDTH: 1030
    };

    var mbObj = document.querySelector('#menuButton');
    var navObj = document.querySelector('nav');

   if (window.innerWidth > param.MENU_MIN_WIDTH) {
      // menu is inside the page
      navObj.classList.add('open');
      navObj.classList.add('inpage');
    }

    mbObj.addEventListener('click', function (e) {
      navObj.classList.toggle('open');
    });

    lazyLoadHTM('nav', '/toc.htm');
  </script>
  
  </body>

</html>