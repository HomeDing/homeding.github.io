<template><svg xmlns='http://www.w3.org/2000/svg'viewBox='-24 -24 48 48'><g id='panel'></g><g id='values'></g></svg></template><style scoped>:host{display:inline-block;width:300px;aspect-ratio:1;--fontSize:3px;--strokeWidth:.2}svg{font-family:sans-serif}.segment{stroke:#fff;stroke-width:var(--strokeWidth)}.text{fill:black;stroke:0;font-size:var(--fontSize);text-anchor:middle;dominant-baseline:middle}</style><script>export default class UPieChart extends UComponent{#t=22;#e={fontSize:"3px",strokeWidth:.2,showTitle:!1,showValue:!1,showPercentage:!1,colors:[]};#o=this.#e;data=[];#s(t,e){return String(Math.sin(t)*e)+","+String(-Math.cos(t)*e)}#i(t,e,o,s){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return o&&Object.getOwnPropertyNames(o).forEach((function(t){i.setAttribute(t,o[t])})),s&&(i.textContent=s),t.appendChild(i),i}#r(t){Array.from(t.childNodes).forEach((function(t){t.remove()}))}_addSlice(t,e,o,s,i){var r=2*Math.PI*t,h=2*Math.PI*(t+e),n=this.#o;let a="M"+this.#s(r,this.#t)+"A"+this.#t+","+this.#t;a+=e<.5?" 0 0 1 ":" 0 1 1 ",a+=this.#s(h,this.#t),a+="L0,0Z";var l=this.#i(this.shadowRoot.querySelector("#panel"),"path",{class:"segment",style:"fill:"+o,d:a});if(n.showTitle||n.showValue||n.showPercentage){const t=[];n.showTitle&&t.push(String(i)),n.showValue&&t.push(Number(s).toLocaleString()),n.showPercentage&&t.push("("+Math.round(100*e)+"%)");var c=window.getComputedStyle(l).fill.match(/\d+/g).reduce((function(t,e){return t+Number(e)}),0)/3,d=this.#s((r+h)/2,.7*this.#t).split(",");this.#i(this.shadowRoot.querySelector("#values"),"text",{class:"text",style:"fill:"+(c>127?"black":"white"),x:d[0],y:d[1]},t.join(" "))}}clear(){const t=this.shadowRoot;this.#r(t.querySelector("#panel")),this.#r(t.querySelector("#values"))}setOptions(t){if(this.#o=Object.assign({},this.#o,t),t.colors){var e=t.colors;"string"==typeof e?this.#o.colors=e.split(","):Array.isArray(e)&&(this.#o.colors=[...e])}this.style.setProperty("--fontSize",this.#o.fontSize),this.style.setProperty("--strokeWidth",this.#o.strokeWidth)}draw(t){this.clear();var e=this.#o.colors,o=this.#o.colors.length;if(t){var s=t.reduce((function(t,e){return t+e.value}),0);t.reduce(function(t,i,r){var h=i.value/s,n=i.color||e[r%o]||"gray";return this._addSlice(t,h,n,i.value,i.title),t+h}.bind(this),0)}}}</script>