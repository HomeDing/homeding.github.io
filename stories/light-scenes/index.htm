
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart control for single and multiple lights</title>
    <script src="/pages.js"></script>
    <link content-type="text/css" href="/docstyle.css" rel="stylesheet"/>
    <script src="/story.js" type="module"></script>
    <link rel="icon" type="image/png" href="/favicon48.png" sizes="48x48">
    <meta name='description' content='Examples and documentation for the HomeDing IoT Library'>
    <meta name="google-site-verification" content="7tTF0t5uCMnyE6X31OIOQpcOf4QxWuODtyZLoVsKCEc"/>
    <meta name="msvalidate.01" content="7FC9C7BCD4002EBD89AAC2EF63D7B353"/>
  </head>
  <body scroll="0" style="padding:0;">
    <div class="u-navbar" style="margin-bottom: 0;">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48" id="menuButton" class="button" style="height:1.4rem">
        <path fill="white" d="M0 8h48v6H0zm0 13h48v6H0zm0 13h48v6H0z"/>
      </svg>
      <a href="/index.htm" class="button">Home</a>
      <a href="/elements/index.htm" class="button">Elements</a>
      <a href="/boards/index.htm" class="button">Boards</a>
      <a href="/recipes/index.htm" class="button">Recipes</a>
    </div>
    <nav></nav>
    <main style="padding:1rem;max-width: 800px;">
      <h1>Smart control for single and multiple lights</h1>
      
        
            <div class="plaincard">
            
            This story is about controlling and automating lights in a room like WiFi Bulbs or Floor Lamps switched on and off by a smart plug to light up for a specific need and create an **Ambience** that fits.

          </div>
        
        <p>The control of all kind of lights is one of the most frequently implemented smart solution for
households and is also supported by the HomeDing library and systems.</p>
<h2>Ambience Light Scenes</h2>
<p>Watching TV, siting at the dinner table or working and the same table – all these require a
specific setup of the lights from a colorful relaying to a bright focusing ambience.</p>
<p>For now let’s assume that we like 3 + 1 (OFF) scenes in a setup:</p>
<p><img src="/elements/sceneui.png" alt="Scene Element UI"></p>
<ul>
<li>A <strong>Dinner</strong> Ambience is needed when meal is on the table but not in bright light, more
focused light and the remaining living room is dimmed but still illuminated.</li>
<li>A <strong>TV</strong> Ambience has a low light situation in the room with some colorful spots.</li>
<li>A <strong>Bright</strong> Ambience is applicable when we need to clean the room.</li>
<li>A <strong>OFF</strong> Ambience is turning all lights off.</li>
</ul>
<p>In contrast to the light specific centrally managed eco-systems like Philips Hue and IKEA TRÅDFRI or the
MQTT based setups with a central server the HomeDing
library based IoT devices support a distributed setups as well.</p>
<p>Using one HomeDing device as a controller for others is the option you may consider when you have to control many lights in a room.</p>
<h2>Configure a Single Light</h2>
<p>Each light (bulb or plug) can participate by using the <a href="/elements/scene.htm">Scene Element</a> to define a specific
local configuration for each scene. This is configured inside every single device by local
scenes definitions.</p>
<p>This allows to configure good setting for each individual situation in the device itself and you can test
and control the scenes through the given Web UI.</p>
<p>For a colorful light like a smart bulb the following configuration can be used as a starting point
that changes the local switch (on/off), the color value and the brightness to fits for any given scene:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scene"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"Dinner"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Dinner"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=1"</span><span class="token punctuation">,</span>
        <span class="token string">"color/0?value=x20200008"</span><span class="token punctuation">,</span>
        <span class="token string">"color/0?brightness=60"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"TV"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"TV"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=1"</span><span class="token punctuation">,</span>
        <span class="token string">"color/0?value=x02400040"</span><span class="token punctuation">,</span>
        <span class="token string">"color/0?brightness=20"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"Bright"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Bright"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=1"</span><span class="token punctuation">,</span>
        <span class="token string">"color/0?value=white"</span><span class="token punctuation">,</span>
        <span class="token string">"color/0?brightness=100"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"Off"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Off"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=0"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token property">"switch"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"0"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Corner"</span><span class="token punctuation">,</span>
      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"switch on/off"</span><span class="token punctuation">,</span>
      <span class="token property">"onvalue"</span><span class="token operator">:</span> <span class="token string">"my9291/0?enable=$v"</span><span class="token punctuation">,</span>
      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"1"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"color"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"0"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Color settings"</span><span class="token punctuation">,</span>
      <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"control color and brightness"</span><span class="token punctuation">,</span>
      <span class="token property">"config"</span><span class="token operator">:</span> <span class="token string">"WRGB"</span><span class="token punctuation">,</span>
      <span class="token property">"mode"</span><span class="token operator">:</span> <span class="token string">"fade"</span><span class="token punctuation">,</span>
      <span class="token property">"duration"</span><span class="token operator">:</span> <span class="token string">"8"</span><span class="token punctuation">,</span>
      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"x12f06c00"</span><span class="token punctuation">,</span>
      <span class="token property">"connect"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"my9291/0"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"my9291"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"0"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"datapin"</span><span class="token operator">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token property">"clockpin"</span><span class="token operator">:</span> <span class="token string">"5"</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>When navigating with the browser to this device you will see that switching to a specific scene
by can be done directly through the Web UI. So even when you have a single RGB
Bulb you can start defining your required scenes and find the best settings.</p>
<h2>Configure the Plugs</h2>
<p>Even for lights that are controlled by simple plug adapters it makes sense to include it at
least in the “Bright” and “OFF” scenes.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scene"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"Dinner"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Dinner"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=1"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"TV"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"TV"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=0"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"Bright"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Bright"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=1"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"Off"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Off"</span><span class="token punctuation">,</span>
      <span class="token property">"steps"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"switch/0?value=0"</span> <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span></code></pre>
<h2>One Control Point</h2>
<p>When you have more that 1 or 2 lights it may be useful to have a central point to change all
relevant lights according to a specific scene by just a single action that can control all devices.</p>
<p>You can use a device with the standard set of elements to control the other devices (bulbs and
plugs are limited due to the 1 MByte flash). E.g. when you have a [RFBridge device] with a
<a href="/elements/rfcodes.htm">RFCodes Element</a> to receive rf 433 frequency signals you can add the following configuration into
this device.</p>
<p>The <a href="/elements/select.htm">Select Element</a> can be used to implement selecting one of the scenes by only one input
event from a button or a remote control.</p>
<p>In the following example a <a href="/elements/select.htm">Select Element</a> with options using the exact names of the scenes is
created. By sending a <code>next</code> action to the <a href="/elements/select.htm">Select Element</a> the scene will be activated. See the
<code>onKey</code> event using the key value to create the scene name to be activated.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"select"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"scenes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"loglevel"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">"cycle"</span><span class="token operator">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>
      <span class="token property">"options"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"Dinner"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"TV"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"Bright"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"Off"</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"onkey"</span><span class="token operator">:</span> <span class="token string">"scene/$v?start=1"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token property">"button"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"next"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"next"</span><span class="token punctuation">,</span>
      <span class="token property">"onclick"</span><span class="token operator">:</span> <span class="token string">"select/scenes?next=1"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>
<p>The <a href="/elements/select.htm">Select Element</a> also simplifies sending the action to activate a new scene to multiple bulbs or plugs
by extending the actions in the <code>onKey</code> event to send the event to a remote device:</p>
<pre class="language-json"><code class="language-json"><span class="token property">"onkey"</span><span class="token operator">:</span> <span class="token string">"bulb01:scene/$v?start=1,bulb02:scene/$v?start=1"</span></code></pre>
<p>By sending <code>select/scenes?key=off</code> it is possible to turn all lights off by a singe event or even by a timer.</p>
<h2>Remote Control</h2>
<p>The <a href="/examples/rfbridge.htm">RFBridge Example</a>
When using a web based UI
is not always available
a simple RF Remote and a RF receiver can be integrated
using the elements</p>
<ul>
<li>rfcodes – receive and decode RF codes</li>
<li>map – to create an action when a specific code was received.
This can in addition control the select or the scene element.</li>
</ul>

        
          <h2>Tags</h2>
          <div class="taglist"><a href="/tag/story.htm">Story</a></div>
        
      </main>
      <script>
        const param = {
          MENU_MIN_WIDTH: 1030
        };
        var mbObj = document.querySelector('#menuButton');
        var navObj = document.querySelector('nav');
        if (window.innerWidth > param.MENU_MIN_WIDTH) { // menu is inside the page
          navObj.classList.add('open');
          navObj.classList.add('inpage');
        }
        mbObj.addEventListener('click', function (e) {
          navObj.classList.toggle('open');
        });
        lazyLoadHTM('nav', '/toc.htm');
      </script>

      <script type="module" async>
        import mermaid from "https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs";
        document.addEventListener('DOMContentLoaded', mermaid.initialize({startOnLoad: true}));
      </script>

    </body>
  </body>
</html>